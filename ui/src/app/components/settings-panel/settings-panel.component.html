<div class="settings-overlay" [class.active]="isOpen" (click)="closePanel()" *ngIf="isOpen"></div>

<div class="settings-panel" [class.active]="isOpen" *ngIf="isOpen">
  <!-- Header -->
  <div class="settings-header">
    <div class="header-content">
      <div class="header-icon">
        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z"/>
          <circle cx="12" cy="12" r="3"/>
        </svg>
      </div>
      <div class="header-title">
        <h2>Settings</h2>
        <p>Customize your experience</p>
      </div>
    </div>
    <button class="close-button" (click)="closePanel()" aria-label="Close settings">
      <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <line x1="18" y1="6" x2="6" y2="18"></line>
        <line x1="6" y1="6" x2="18" y2="18"></line>
      </svg>
    </button>
  </div>

  <!-- Content -->
  <div class="settings-content">

    <!-- Quick Filters Section -->
    <div class="settings-section">
      <div class="section-header">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <polygon points="22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3"/>
        </svg>
        <div class="section-title">
          <h3>Quick Filters</h3>
          <p>Apply preset filters to your process list</p>
        </div>
      </div>

      <div class="setting-group">
        <div class="filter-presets-grid">
          <button
            *ngFor="let preset of filterPresets"
            class="filter-preset-btn"
            [class.active]="isFilterActive(preset.name)"
            (click)="toggleFilterPreset(preset.name)"
            [attr.aria-label]="preset.description"
            [title]="preset.description">
            <span class="filter-icon">{{ preset.icon }}</span>
            <span class="filter-name">{{ preset.name }}</span>
            <span class="filter-status" *ngIf="isFilterActive(preset.name)">✓</span>
          </button>
        </div>
        <p class="filter-hint">
          <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <circle cx="12" cy="12" r="10"/>
            <line x1="12" y1="16" x2="12" y2="12"/>
            <line x1="12" y1="8" x2="12.01" y2="8"/>
          </svg>
          Click a filter to enable it. Click again to disable. Only one filter can be active at a time.
        </p>
      </div>
    </div>

    <!-- Appearance Section -->
    <div class="settings-section">
      <div class="section-header">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <circle cx="12" cy="12" r="4"/>
          <path d="M12 2v2M12 20v2M4.93 4.93l1.41 1.41M17.66 17.66l1.41 1.41M2 12h2M20 12h2M6.34 17.66l-1.41 1.41M19.07 4.93l-1.41 1.41"/>
        </svg>
        <div class="section-title">
          <h3>Appearance</h3>
          <p>Customize the look and feel</p>
        </div>
      </div>

      <div class="setting-group">
        <div class="setting-item">
          <div class="setting-info">
            <label for="theme-select">Theme Mode</label>
            <span class="setting-description">Choose your preferred color scheme</span>
          </div>
          <div class="theme-selector">
            <button
              class="theme-option"
              [class.active]="settings.theme === 'light'"
              (click)="updateSetting('theme', 'light')"
              aria-label="Light theme">
              <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <circle cx="12" cy="12" r="4"/>
                <path d="M12 2v2M12 20v2M4.93 4.93l1.41 1.41M17.66 17.66l1.41 1.41M2 12h2M20 12h2M6.34 17.66l-1.41 1.41M19.07 4.93l-1.41 1.41"/>
              </svg>
              <span>Light</span>
            </button>
            <button
              class="theme-option"
              [class.active]="settings.theme === 'dark'"
              (click)="updateSetting('theme', 'dark')"
              aria-label="Dark theme">
              <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"/>
              </svg>
              <span>Dark</span>
            </button>
            <button
              class="theme-option"
              [class.active]="settings.theme === 'auto'"
              (click)="updateSetting('theme', 'auto')"
              aria-label="Auto theme">
              <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <rect x="2" y="3" width="20" height="14" rx="2" ry="2"/>
                <line x1="8" y1="21" x2="16" y2="21"/>
                <line x1="12" y1="17" x2="12" y2="21"/>
              </svg>
              <span>Auto</span>
            </button>
          </div>
        </div>

        <div class="setting-item">
          <div class="setting-info">
            <label for="font-size">Font Size</label>
            <span class="setting-description">Adjust text readability</span>
          </div>
          <div class="slider-control">
            <span class="slider-label">{{ settings.fontSize }}px</span>
            <input
              type="range"
              id="font-size"
              min="12"
              max="18"
              [value]="settings.fontSize"
              (input)="updateSetting('fontSize', $any($event.target).value)"
              class="slider">
            <div class="slider-markers">
              <span>12</span>
              <span>15</span>
              <span>18</span>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Accessibility Section -->
    <div class="settings-section">
      <div class="section-header">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"/>
          <circle cx="9" cy="7" r="4"/>
          <path d="M23 21v-2a4 4 0 0 0-3-3.87M16 3.13a4 4 0 0 1 0 7.75"/>
        </svg>
        <div class="section-title">
          <h3>Accessibility</h3>
          <p>Improve usability and comfort</p>
        </div>
      </div>

      <div class="setting-group">
        <div class="setting-item">
          <div class="setting-info">
            <label for="high-contrast">High Contrast Mode</label>
            <span class="setting-description">Enhance visual clarity</span>
          </div>
          <label class="toggle-switch">
            <input
              type="checkbox"
              id="high-contrast"
              [checked]="settings.highContrast"
              (change)="updateSetting('highContrast', $any($event.target).checked)">
            <span class="toggle-slider"></span>
          </label>
        </div>

        <div class="setting-item">
          <div class="setting-info">
            <label for="reduce-motion">Reduce Motion</label>
            <span class="setting-description">Minimize animations</span>
          </div>
          <label class="toggle-switch">
            <input
              type="checkbox"
              id="reduce-motion"
              [checked]="settings.reduceMotion"
              (change)="updateSetting('reduceMotion', $any($event.target).checked)">
            <span class="toggle-slider"></span>
          </label>
        </div>

        <div class="setting-item">
          <div class="setting-info">
            <label for="keyboard-nav">Enhanced Keyboard Navigation</label>
            <span class="setting-description">Improve keyboard accessibility</span>
          </div>
          <label class="toggle-switch">
            <input
              type="checkbox"
              id="keyboard-nav"
              [checked]="settings.keyboardNavigation"
              (change)="updateSetting('keyboardNavigation', $any($event.target).checked)">
            <span class="toggle-slider"></span>
          </label>
        </div>
      </div>
    </div>

    <!-- Notifications Section -->
    <div class="settings-section">
      <div class="section-header">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9"/>
          <path d="M13.73 21a2 2 0 0 1-3.46 0"/>
        </svg>
        <div class="section-title">
          <h3>Notifications</h3>
          <p>Manage alerts and reminders</p>
        </div>
      </div>

      <div class="setting-group">
        <div class="setting-item">
          <div class="setting-info">
            <label for="enable-notifications">Email Notifications</label>
            <span class="setting-description">Receive updates via email</span>
          </div>
          <label class="toggle-switch">
            <input
              type="checkbox"
              id="enable-notifications"
              [checked]="settings.notifications?.email"
              (change)="updateSetting('notifications.email', $any($event.target).checked)">
            <span class="toggle-slider"></span>
          </label>
        </div>

        <div class="setting-item">
          <div class="setting-info">
            <label for="desktop-notifications">Desktop Notifications</label>
            <span class="setting-description">Show desktop notifications</span>
          </div>
          <label class="toggle-switch">
            <input
              type="checkbox"
              id="desktop-notifications"
              [checked]="settings.notifications?.desktop"
              (change)="updateSetting('notifications.desktop', $any($event.target).checked)">
            <span class="toggle-slider"></span>
          </label>
        </div>

        <div class="setting-item">
          <div class="setting-info">
            <label for="followup-notifications">Follow-up Reminders</label>
            <span class="setting-description">Get reminded about follow-ups</span>
          </div>
          <label class="toggle-switch">
            <input
              type="checkbox"
              id="followup-notifications"
              [checked]="settings.notifications?.followUps"
              (change)="updateSetting('notifications.followUps', $any($event.target).checked)">
            <span class="toggle-slider"></span>
          </label>
        </div>

        <div class="setting-item">
          <div class="setting-info">
            <label for="interview-notifications">Interview Reminders</label>
            <span class="setting-description">Get reminded about interviews</span>
          </div>
          <label class="toggle-switch">
            <input
              type="checkbox"
              id="interview-notifications"
              [checked]="settings.notifications?.interviews"
              (change)="updateSetting('notifications.interviews', $any($event.target).checked)">
            <span class="toggle-slider"></span>
          </label>
        </div>
      </div>
    </div>

    <!-- Display Preferences Section -->
    <div class="settings-section">
      <div class="section-header">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <rect x="2" y="3" width="20" height="14" rx="2" ry="2"/>
          <line x1="8" y1="21" x2="16" y2="21"/>
          <line x1="12" y1="17" x2="12" y2="21"/>
        </svg>
        <div class="section-title">
          <h3>Display Preferences</h3>
          <p>Control what you see</p>
        </div>
      </div>

      <div class="setting-group">
        <div class="setting-item">
          <div class="setting-info">
            <label for="compact-mode">Compact View</label>
            <span class="setting-description">Show more content at once</span>
          </div>
          <label class="toggle-switch">
            <input
              type="checkbox"
              id="compact-mode"
              [checked]="settings.compactMode"
              (change)="updateSetting('compactMode', $any($event.target).checked)">
            <span class="toggle-slider"></span>
          </label>
        </div>

        <div class="setting-item">
          <div class="setting-info">
            <label for="show-tooltips">Show Tooltips</label>
            <span class="setting-description">Display helpful hints</span>
          </div>
          <label class="toggle-switch">
            <input
              type="checkbox"
              id="show-tooltips"
              [checked]="settings.showTooltips"
              (change)="updateSetting('showTooltips', $any($event.target).checked)">
            <span class="toggle-slider"></span>
          </label>
        </div>

        <div class="setting-item">
          <div class="setting-info">
            <label for="auto-save">Auto-save</label>
            <span class="setting-description">Automatically save your work</span>
          </div>
          <label class="toggle-switch">
            <input
              type="checkbox"
              id="auto-save"
              [checked]="settings.autoSave"
              (change)="updateSetting('autoSave', $any($event.target).checked)">
            <span class="toggle-slider"></span>
          </label>
        </div>
      </div>
    </div>

    <!-- Data & Privacy Section -->
    <div class="settings-section">
      <div class="section-header">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <rect x="3" y="11" width="18" height="11" rx="2" ry="2"/>
          <path d="M7 11V7a5 5 0 0 1 10 0v4"/>
        </svg>
        <div class="section-title">
          <h3>Data & Privacy</h3>
          <p>Control your information</p>
        </div>
      </div>

      <div class="setting-group">
        <div class="setting-item">
          <div class="setting-info">
            <label for="analytics">Usage Analytics</label>
            <span class="setting-description">Help us improve the app</span>
          </div>
          <label class="toggle-switch">
            <input
              type="checkbox"
              id="analytics"
              [checked]="settings.analytics"
              (change)="updateSetting('analytics', $any($event.target).checked)">
            <span class="toggle-slider"></span>
          </label>
        </div>

        <div class="setting-item">
          <div class="setting-info">
            <label>Data Management</label>
            <span class="setting-description">Export or delete your data</span>
          </div>
          <div class="button-group">
            <button class="secondary-button" (click)="exportData()">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
                <polyline points="7 10 12 15 17 10"/>
                <line x1="12" y1="15" x2="12" y2="3"/>
              </svg>
              Export Data
            </button>
            <button class="secondary-button danger" (click)="clearData()">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <polyline points="3 6 5 6 21 6"/>
                <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"/>
              </svg>
              Clear Cache
            </button>
          </div>
        </div>
      </div>
    </div>

  </div>

  <!-- Footer -->
  <div class="settings-footer">
    <div class="footer-info">
      <span class="version">Version 2.0.0</span>
      <span class="separator">•</span>
      <a href="#" class="footer-link">Help</a>
      <span class="separator">•</span>
      <a href="#" class="footer-link">Privacy Policy</a>
    </div>
    <button class="primary-button" (click)="resetToDefaults()">
      <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <polyline points="23 4 23 10 17 10"/>
        <path d="M20.49 15a9 9 0 1 1-2.12-9.36L23 10"/>
      </svg>
      Reset to Defaults
    </button>
  </div>
</div>
