<div class="settings-overlay" (click)="closePanel()">
  <div class="settings-panel" (click)="$event.stopPropagation()">
    <!-- Header -->
    <div class="panel-header">
      <h2>‚öôÔ∏è Settings</h2>
      <button class="btn-close" (click)="closePanel()" aria-label="Close settings">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <line x1="18" y1="6" x2="6" y2="18"></line>
          <line x1="6" y1="6" x2="18" y2="18"></line>
        </svg>
      </button>
    </div>

    <!-- User Profile Section -->
    <div class="settings-section" *ngIf="currentUser">
      <div class="profile-card">
        <div class="profile-avatar">
          {{ currentUser.email?.charAt(0).toUpperCase() || 'U' }}
        </div>
        <div class="profile-info">
          <div class="profile-name">{{ currentUser.email }}</div>
          <div class="profile-role">Job Seeker</div>
        </div>
      </div>
    </div>
    <!-- Appearance Settings -->
    <div class="settings-section">
      <h3 class="section-title">üé® Appearance</h3>

      <div class="setting-item">
        <label class="setting-label">Theme</label>
        <div class="theme-options">
          <button
            class="theme-btn"
            [class.active]="settings.theme === 'light'"
            (click)="onThemeChange('light')">
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <circle cx="12" cy="12" r="5"></circle>
              <line x1="12" y1="1" x2="12" y2="3"></line>
              <line x1="12" y1="21" x2="12" y2="23"></line>
              <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
              <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
              <line x1="1" y1="12" x2="3" y2="12"></line>
              <line x1="21" y1="12" x2="23" y2="12"></line>
              <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
              <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
            </svg>
            <span>Light</span>
          </button>
          <button
            class="theme-btn"
            [class.active]="settings.theme === 'dark'"
            (click)="onThemeChange('dark')">
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
            </svg>
            <span>Dark</span>
          </button>
          <button
            class="theme-btn"
            [class.active]="settings.theme === 'auto'"
            (click)="onThemeChange('auto')">
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <rect x="2" y="3" width="20" height="14" rx="2" ry="2"></rect>
              <line x1="8" y1="21" x2="16" y2="21"></line>
              <line x1="12" y1="17" x2="12" y2="21"></line>
            </svg>
            <span>Auto</span>
          </button>
        </div>
      </div>
    </div>



    <!-- Date & Time Settings -->
    <div class="settings-section">
      <h3 class="section-title">üïê Date & Time</h3>

      <div class="setting-item">
        <label class="setting-label">Clock Format</label>
        <div class="radio-group">
          <label class="radio-option">
            <input
              type="radio"
              name="clockFormat"
              value="12"
              [checked]="settings.clockFormat === '12'"
              (change)="onClockFormatChange('12')">
            <span>12-hour (2:30 PM)</span>
          </label>
          <label class="radio-option">
            <input
              type="radio"
              name="clockFormat"
              value="24"
              [checked]="settings.clockFormat === '24'"
              (change)="onClockFormatChange('24')">
            <span>24-hour (14:30)</span>
          </label>
        </div>
      </div>

      <div class="setting-item">
        <label class="setting-label">Date Format</label>
        <div class="radio-group">
          <label class="radio-option">
            <input
              type="radio"
              name="dateFormat"
              value="DD/MM/YYYY"
              [checked]="settings.dateFormat === 'DD/MM/YYYY'"
              (change)="onDateFormatChange('DD/MM/YYYY')">
            <span>DD/MM/YYYY (31/12/2024)</span>
          </label>
          <label class="radio-option">
            <input
              type="radio"
              name="dateFormat"
              value="MM/DD/YYYY"
              [checked]="settings.dateFormat === 'MM/DD/YYYY'"
              (change)="onDateFormatChange('MM/DD/YYYY')">
            <span>MM/DD/YYYY (12/31/2024)</span>
          </label>
          <label class="radio-option">
            <input
              type="radio"
              name="dateFormat"
              value="YYYY-MM-DD"
              [checked]="settings.dateFormat === 'YYYY-MM-DD'"
              (change)="onDateFormatChange('YYYY-MM-DD')">
            <span>YYYY-MM-DD (2024-12-31)</span>
          </label>
        </div>
      </div>
    </div>

    <div class="settings-section">
      <h3 class="section-title">üåç Location</h3>

      <div class="setting-item">
        <label class="setting-label">Country</label>
        <div class="country-combobox" [class.open]="showCountryDropdown">
          <input
            class="input-field"
            type="text"
            name="country"
            autocomplete="off"
            [(ngModel)]="countrySearch"
            (input)="onCountrySearchChange()"
            (focus)="onCountrySearchChange()"
            placeholder="Start typing to search...">
          <button
            type="button"
            class="country-toggle"
            aria-label="Toggle country list"
            (click)="toggleCountryDropdown()">
            <span aria-hidden="true">‚ñæ</span>
          </button>
          <div class="country-dropdown" *ngIf="showCountryDropdown">
            <button
              type="button"
              class="country-option"
              *ngFor="let country of filteredCountryOptions"
              (click)="selectCountry(country)">
              {{ country }}
            </button>
            <div class="country-empty" *ngIf="filteredCountryOptions.length === 0">
              No matches found
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Notifications Settings -->
    <div class="settings-section">
      <h3 class="section-title">üîî Notifications</h3>

      <div class="setting-item">
        <label class="toggle-setting">
          <input
            type="checkbox"
            [(ngModel)]="settings.notifications.email"
            (change)="onNotificationChange('email', settings.notifications.email)">
          <span class="toggle-label">Email Notifications</span>
        </label>
      </div>

      <div class="setting-item">
        <label class="toggle-setting">
          <input
            type="checkbox"
            [(ngModel)]="settings.notifications.desktop"
            (change)="onNotificationChange('desktop', settings.notifications.desktop)">
          <span class="toggle-label">Desktop Notifications</span>
        </label>
      </div>

      <div class="setting-item">
        <label class="toggle-setting">
          <input
            type="checkbox"
            [(ngModel)]="settings.notifications.followUps"
            (change)="onNotificationChange('followUps', settings.notifications.followUps)">
          <span class="toggle-label">Follow-up Reminders</span>
        </label>
      </div>

      <div class="setting-item">
        <label class="toggle-setting">
          <input
            type="checkbox"
            [(ngModel)]="settings.notifications.interviews"
            (change)="onNotificationChange('interviews', settings.notifications.interviews)">
          <span class="toggle-label">Interview Reminders</span>
        </label>
      </div>
    </div>


    <!-- Dashboard Settings -->
    <div class="settings-section">
      <h3 class="section-title">üìä Dashboard</h3>

      <div class="setting-item">
        <label class="toggle-setting">
          <input
            type="checkbox"
            [(ngModel)]="settings.dashboard.showStats"
            (change)="onDashboardChange('showStats', settings.dashboard.showStats)">
          <span class="toggle-label">Show Statistics</span>
        </label>
      </div>

      <div class="setting-item">
        <label class="toggle-setting">
          <input
            type="checkbox"
            [(ngModel)]="settings.dashboard.showTasks"
            (change)="onDashboardChange('showTasks', settings.dashboard.showTasks)">
          <span class="toggle-label">Show Tasks</span>
        </label>
      </div>

      <div class="setting-item">
        <label class="setting-label">Default View</label>
        <div class="radio-group">
          <label class="radio-option">
            <input
              type="radio"
              name="defaultView"
              value="grid"
              [checked]="settings.dashboard.defaultView === 'grid'"
              (change)="onDashboardChange('defaultView', 'grid')">
            <span>Grid View</span>
          </label>
          <label class="radio-option">
            <input
              type="radio"
              name="defaultView"
              value="list"
              [checked]="settings.dashboard.defaultView === 'list'"
              (change)="onDashboardChange('defaultView', 'list')">
            <span>List View</span>
          </label>
        </div>
      </div>
    </div>



    <!-- Actions -->
    <div class="settings-section">
      <h3 class="section-title">‚ö° Actions</h3>

      <button class="action-btn reset-btn" (click)="resetSettings()">
        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <polyline points="23 4 23 10 17 10"></polyline>
          <path d="M20.49 15a9 9 0 1 1-2.12-9.36L23 10"></path>
        </svg>
        <span>Reset to Defaults</span>
      </button>

      <button class="action-btn logout-btn" (click)="logout()">
        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"></path>
          <polyline points="16 17 21 12 16 7"></polyline>
          <line x1="21" y1="12" x2="9" y2="12"></line>
        </svg>
        <span>Logout</span>
      </button>
    </div>

    <!-- Footer -->
    <div class="panel-footer">
      <p class="version-info">Lida Job assistance v1.0.0</p>
    </div>
  </div>
</div>
