<div class="cv-shell" *ngIf="!loading && (aiProfile || profile); else loadingState">
    <header class="cv-header">
        <div>
            <span class="cv-label">{{ useAi ? 'AI-Polished CV' : 'Professional CV' }}</span>
            <h1 class="cv-name">Career Profile</h1>
            <p class="cv-subtitle">
                {{ useAi ? 'A professional summary refined by DeepSeek AI.' : 'A polished summary generated from your profile details.' }}
            </p>
            <p class="cv-note" *ngIf="useAi && aiProfile?.aiEnabled">Last generated by AI using your latest profile data.</p>
            <p class="cv-warning" *ngIf="useAi && aiProfile && !aiProfile.aiEnabled">
                DeepSeek AI is not configured yet. Add your API key in backend/.env to enable AI polishing.
            </p>
            <a *ngIf="aiProfile?.lastCvUrl" class="cv-last-link" [routerLink]="[aiProfile.lastCvUrl]">
                Open last generated CV
            </a>
            <p *ngIf="aiProfile?.lastCvGeneratedAt" class="cv-note">
                Last generated {{ aiProfile.lastCvGeneratedAt | date: 'medium' }}
            </p>
        </div>
        <div class="cv-contact">
            <div class="contact-item">
                <span class="contact-label">Highlights</span>
                <span class="contact-value">{{ aiProfile?.topSkills || profile?.topSkills || 'Add top skills to showcase your strengths.' }}</span>
            </div>
        </div>
    </header>

    <section class="cv-section">
        <h2>About</h2>
        <p>{{ aiProfile?.about || profile?.about || 'Add an about section to give recruiters context.' }}</p>
    </section>

    <section class="cv-grid">
        <div class="cv-card">
            <h3>Experience</h3>
            <p>{{ aiProfile?.experience || profile?.experience || 'Summarize your experience here.' }}</p>
        </div>
        <div class="cv-card">
            <h3>Old Companies</h3>
            <p>{{ aiProfile?.oldCompanies || profile?.oldCompanies || 'List previous companies to show credibility.' }}</p>
        </div>
    </section>

    <section class="cv-grid">
        <div class="cv-card">
            <h3>Activity</h3>
            <p>{{ aiProfile?.activity || profile?.activity || 'Add any public speaking, awards, or community work.' }}</p>
        </div>
        <div class="cv-card">
            <h3>Private Projects</h3>
            <p>{{ aiProfile?.privateProjects || profile?.privateProjects || 'Showcase your side projects and initiatives.' }}</p>
        </div>
    </section>

    <section class="cv-grid">
        <div class="cv-card">
            <h3>Education</h3>
            <p>{{ aiProfile?.education || profile?.education || 'Highlight education and training.' }}</p>
        </div>
        <div class="cv-card">
            <h3>Certifications</h3>
            <p>{{ aiProfile?.certifications || profile?.certifications || 'Add certifications and licenses.' }}</p>
        </div>
    </section>

    <section class="cv-section">
        <h2>Links</h2>
        <p>{{ aiProfile?.links || profile?.links || 'Add portfolio links, GitHub, LinkedIn, etc.' }}</p>
    </section>
</div>

<ng-template #loadingState>
    <div class="cv-loading">
        <div class="loading-card"></div>
        <div class="loading-card"></div>
        <div class="loading-card"></div>
    </div>
</ng-template>