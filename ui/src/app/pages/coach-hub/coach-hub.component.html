<div class="coach-hub-container">
  <!-- Sidebar -->
  <aside class="sidebar">
    <div class="sidebar-title">
      <span>ğŸ›¡ï¸</span> Coach Hub
    </div>

    <nav class="nav-section">
      <span class="nav-label">Library</span>
      <div class="nav-item" [class.active]="!currentFolder" (click)="navigateToFolder(null)">
        <span>ğŸ </span> My Documents
      </div>
      <div class="nav-item">
        <span>â­</span> Favorites
      </div>
      <div class="nav-item">
        <span>ğŸ•’</span> Recent
      </div>
    </nav>

    <nav class="nav-section plan-usage-section">
      <span class="nav-label">Plan Usage</span>
      <div class="usage-status" [class.usage-full]="isLimitReached">
        <div class="usage-header">
          <span class="usage-label">{{ isPremium ? 'Premium Plan' : 'Free Plan' }}</span>
          <span class="usage-count" *ngIf="!isPremium">{{ docCount }}/{{ MAX_FREE_DOCUMENTS }} files</span>
          <span class="usage-count" *ngIf="isPremium">{{ docCount }} files</span>
        </div>
        <div class="usage-bar" *ngIf="!isPremium">
          <div class="usage-fill" [style.width.%]="(docCount / MAX_FREE_DOCUMENTS) * 100"></div>
        </div>
        <p class="usage-hint" *ngIf="!isPremium">
          {{ docsRemaining }} slots left for free
        </p>
        <button class="btn-upgrade-sidebar" *ngIf="!isPremium" (click)="goToPricing()">
          <span>ğŸ’</span> Upgrade to Unlimited
        </button>
        <div class="premium-badge-sidebar" *ngIf="isPremium">
          <span>âœ¨</span> Unlimited Storage
        </div>
      </div>
    </nav>

    <nav class="nav-section">
      <span class="nav-label">Labels</span>
      <div class="nav-item">
        <span>ğŸ“Œ</span> Important
      </div>
      <div class="nav-item">
        <span>ğŸ“</span> Personal Notes
      </div>
    </nav>
  </aside>

  <!-- Main Content -->
  <main class="main-content">
    <!-- Header -->
    <header class="content-header">
      <div class="breadcrumb-nav">
        <span class="breadcrumb-item" (click)="navigateToFolder(null)">Root</span>
        <ng-container *ngFor="let crumb of breadcrumbs">
          <span class="breadcrumb-sep">/</span>
          <span class="breadcrumb-item" (click)="navigateToFolder(crumb)">{{ crumb.name }}</span>
        </ng-container>
      </div>

      <div class="header-actions">
        <div class="premium-tip" *ngIf="!isPremium" (click)="goToPricing()">
          <span>ğŸš€</span> Unlock Unlimited Storage
        </div>
        <button class="btn-secondary" (click)="showNewFolderModal = true">
          <span>ğŸ“</span> New Folder
        </button>
        <div class="upload-wrapper" [class.disabled]="isLimitReached" (click)="isLimitReached ? goToPricing() : null">
          <button class="btn-primary" [disabled]="isLimitReached" (click)="$event.stopPropagation(); fileInput.click()">
            <span>ğŸ“¤</span> {{ isLimitReached ? 'Limit Reached' : 'Upload File' }}
          </button>
          <div class="upload-tooltip" *ngIf="isLimitReached">
            Upgrade for unlimited uploads ğŸš€
          </div>
        </div>
        <input #fileInput type="file" (change)="onFileUpload($event)" style="display: none"
          accept=".pdf,.doc,.docx,.xls,.xlsx,application/pdf,application/msword,application/vnd.openxmlformats-officedocument.wordprocessingml.document,application/vnd.ms-excel,application/vnd.openxmlformats-officedocument.spreadsheetml.sheet">
      </div>
    </header>

    <!-- Loading State -->
    <div class="empty-state" *ngIf="isLoading">
      <div class="spinner"></div>
      <p>Scanning your documents...</p>
    </div>

    <!-- Items Grid -->
    <div class="items-grid" *ngIf="!isLoading">
      <!-- Folders -->
      <div class="grid-item folder-item" *ngFor="let folder of folders; let i = index" [style.--i]="i"
        (click)="navigateToFolder(folder)">
        <div class="item-actions">
          <button class="action-btn-subtle" (click)="deleteFolder($event, folder)">ğŸ—‘ï¸</button>
        </div>
        <div class="item-icon folder-icon">ğŸ“‚</div>
        <div class="item-name">{{ folder.name }}</div>
        <div class="item-meta">Folder</div>
      </div>

      <!-- Documents -->
      <div class="grid-item file-item" *ngFor="let doc of getCurrentDocuments(); let i = index"
        [style.--i]="i + folders.length" (click)="downloadFile($event, doc)">
        <div class="item-actions">
          <button class="action-btn-subtle" (click)="deleteFile($event, doc)">ğŸ—‘ï¸</button>
        </div>
        <div class="item-icon file-icon">{{ getFileIcon(doc.type) }}</div>
        <div class="item-name">{{ doc.title }}</div>
        <div class="item-meta">{{ formatDate(doc.updatedAt) }}</div>
      </div>

      <!-- Empty State if no content -->
      <div class="empty-state" *ngIf="folders.length === 0 && getCurrentDocuments().length === 0">
        <div class="empty-state-icon">ğŸ“‚</div>
        <h3>This folder is empty</h3>
        <p>Upload files or create folders to get started</p>
        <div class="empty-actions">
          <button class="btn-glass" (click)="isLimitReached ? goToPricing() : fileInput.click()">
            {{ isLimitReached ? 'ğŸ’ View Plans for Unlimited Storage' : 'Upload First File' }}
          </button>
        </div>
      </div>
    </div>
  </main>

  <!-- New Folder Modal -->
  <div class="modal-overlay" *ngIf="showNewFolderModal" (click)="showNewFolderModal = false">
    <div class="modal-card" (click)="$event.stopPropagation()">
      <div class="modal-header">
        <h2>Create New Folder</h2>
      </div>
      <div class="form-group">
        <label class="nav-label">Folder Name</label>
        <input type="text" [(ngModel)]="newFolderName" placeholder="Enter folder name..." class="input-field" autoFocus
          (keyup.enter)="createFolder()">
      </div>
      <div class="form-actions" style="display: flex; gap: 1rem; justify-content: flex-end;">
        <button class="btn-secondary" (click)="showNewFolderModal = false">Cancel</button>
        <button class="btn-primary" (click)="createFolder()" [disabled]="!newFolderName.trim()">Create Folder</button>
      </div>
    </div>
  </div>
</div>