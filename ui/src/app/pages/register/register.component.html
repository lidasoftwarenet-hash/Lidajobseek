<div class="register-page">
  <div class="register-card" *ngIf="!isRegistered; else successState">
    <div class="top-actions">
      <button type="button" class="link top-link" (click)="goToLogin()">‚Üê Back to login</button>
    </div>
    <h1>Join Lida Job Assistance</h1>
    <p class="subtitle">Professional onboarding. Built for secure, trusted job management.</p>

    <form (ngSubmit)="submit()" novalidate>
      <label>
        <span>Email</span>
        <input type="email" [(ngModel)]="form.email" name="email" placeholder="you@company.com" />
        <small *ngIf="errors.email">{{ errors.email }}</small>
      </label>

      <label>
        <span>User name</span>
        <input type="text" [(ngModel)]="form.username" name="username" placeholder="First name and last name" />
        <small *ngIf="errors.username">{{ errors.username }}</small>
      </label>

      <ngx-intl-tel-input
      [cssClass]="'custom-phone-input'"
      [preferredCountries]="['il', 'us', 'gb']"
      [enableAutoCountrySelect]="true"
      [enablePlaceholder]="true"
      [searchCountryFlag]="true"
      name="phone"
      [(ngModel)]="form.phone">
      </ngx-intl-tel-input>

      <label>
        <span>Password</span>
        <input type="password" [(ngModel)]="form.password" name="password" placeholder="At least 8 characters" />
        <small *ngIf="errors.password">{{ errors.password }}</small>
      </label>

      <label>
        <span>Confirm password</span>
        <input
          type="password"
          [(ngModel)]="form.confirmPassword"
          name="confirmPassword"
          placeholder="Re-enter your password"
        />
        <small *ngIf="errors.confirmPassword">{{ errors.confirmPassword }}</small>
      </label>

      <button type="submit" [disabled]="isSubmitting">
        {{ isSubmitting ? 'Creating Account...' : 'Create Account' }}
      </button>

      <button type="button" class="link" (click)="goToLogin()">Already have an account? Sign in</button>
    </form>

    <section class="trust-panel" aria-label="Security and trust">
      <div class="trust-item">
        <span class="trust-icon">üîí</span>
        <div>
          <h3>Enterprise-grade security</h3>
          <p>Your account and personal data are protected with modern security standards.</p>
        </div>
      </div>
      <div class="trust-item">
        <span class="trust-icon">üõ°Ô∏è</span>
        <div>
          <h3>Safe verification process</h3>
          <p>Email activation ensures only you can enable your account access.</p>
        </div>
      </div>
      <div class="trust-item">
        <span class="trust-icon">‚úÖ</span>
        <div>
          <h3>Trusted platform</h3>
          <p>Used by professionals to manage career opportunities with confidence.</p>
        </div>
      </div>
    </section>
  </div>

  <ng-template #successState>
    <div class="register-card success">
      <div class="top-actions success-top">
        <button type="button" class="link top-link" (click)="goToLogin()">Go to login</button>
      </div>
      <div class="icon">‚úì</div>
      <h1>Account created successfully</h1>
      <p>
        Your account is currently pending activation. Please check your email and click the activation link to continue.
      </p>
      <p class="success-note">Security first: your account stays inactive until email verification is completed.</p>
      <button type="button" (click)="goToLogin()">Back to Login</button>
    </div>
  </ng-template>

  <div class="modal-backdrop" *ngIf="showPopup">
    <div class="modal-card" (click)="$event.stopPropagation()">
      <h3>{{ popupTitle }}</h3>
      <p>{{ popupMessage }}</p>
      <button type="button" (click)="closePopup()">Understood</button>
    </div>
  </div>
</div>
