<div class="register-page">
  <div class="register-card" *ngIf="!isRegistered; else successState">
    <div class="top-actions">
      <button type="button" class="link top-link" (click)="goToLogin()">‚Üê Back to login</button>
    </div>
    <div class="title-lida">Join Lida Job Assistance</div>
    <p class="subtitle">Professional onboarding. Built for secure, trusted job management.</p>

    <section class="social-auth" aria-label="Continue with social account">
      <button type="button" class="social-btn google" (click)="continueWith('google')">
        <svg viewBox="0 0 24 24" aria-hidden="true">
          <path fill="#EA4335" d="M12 10.2v3.9h5.5c-.2 1.2-.9 2.3-1.9 3.1l3.1 2.4c1.8-1.6 2.9-4 2.9-6.9 0-.7-.1-1.4-.2-2H12z"/>
          <path fill="#34A853" d="M12 21.5c2.6 0 4.8-.9 6.4-2.4l-3.1-2.4c-.9.6-2 .9-3.3.9-2.5 0-4.6-1.7-5.4-3.9H3.4v2.5c1.6 3.2 4.9 5.3 8.6 5.3z"/>
          <path fill="#FBBC05" d="M6.6 13.7c-.2-.6-.3-1.2-.3-1.8s.1-1.3.3-1.8V7.6H3.4C2.8 8.8 2.5 10.1 2.5 12s.3 3.2.9 4.4l3.2-2.7z"/>
          <path fill="#4285F4" d="M12 6.4c1.4 0 2.7.5 3.7 1.4l2.7-2.7C16.8 3.6 14.6 2.5 12 2.5c-3.7 0-7 2.1-8.6 5.1l3.2 2.5c.8-2.3 2.9-3.7 5.4-3.7z"/>
        </svg>
        <span>Continue with Google</span>
      </button>

      <button type="button" class="social-btn linkedin" (click)="continueWith('linkedin')">
        <svg viewBox="0 0 24 24" aria-hidden="true">
          <path fill="currentColor" d="M6.4 8.2a1.9 1.9 0 1 1 0-3.8 1.9 1.9 0 0 1 0 3.8zM4.8 9.8h3.2v9.4H4.8V9.8zm5.1 0h3v1.3h.1c.4-.8 1.5-1.6 3.1-1.6 3.3 0 3.9 2.2 3.9 5v4.7h-3.2V15c0-1-.1-2.3-1.4-2.3s-1.6 1.1-1.6 2.2v4.3H9.9V9.8z"/>
        </svg>
        <span>Continue with LinkedIn</span>
      </button>

      <button type="button" class="social-btn facebook" (click)="continueWith('facebook')">
        <svg viewBox="0 0 24 24" aria-hidden="true">
          <path fill="currentColor" d="M13.5 21v-8h2.7l.4-3.1h-3.1V7.8c0-.9.3-1.5 1.6-1.5h1.7V3.4c-.3 0-1.3-.1-2.5-.1-2.5 0-4.1 1.5-4.1 4.3V10H7.6V13h2.6v8h3.3z"/>
        </svg>
        <span>Continue with Facebook</span>
      </button>
    </section>

    <div class="social-divider" aria-hidden="true">
      <span>or create account with email</span>
    </div>

    <form (ngSubmit)="submit()" novalidate>
      <label>
        <span>Email</span>
        <input type="email" [(ngModel)]="form.email" name="email" placeholder="you@company.com" />
        <small *ngIf="errors.email">{{ errors.email }}</small>
      </label>

      <label>
        <span>User name</span>
        <input type="text" [(ngModel)]="form.username" name="username" placeholder="First name and last name" />
        <small *ngIf="errors.username">{{ errors.username }}</small>
      </label>

      <label class="phone-section">
        <span>
          Phone number & country code
          <em class="optional-badge">(optional)</em>
        </span>
        <div class="phone-input-group">
          <div class="country-dropdown" [class.open]="isCountryMenuOpen">
            <button
              type="button"
              class="country-code country-toggle"
              (click)="toggleCountryMenu()"
              [attr.aria-expanded]="isCountryMenuOpen"
              aria-label="Choose country code">
              <img
                class="flag-img"
                [src]="selectedCountry?.flagUrl"
                [alt]="selectedCountry?.isoCode + ' flag'" />
              <span class="country-short">{{ selectedCountry?.dialCode }}</span>
              <span class="country-chevron">‚ñæ</span>
            </button>

            <div class="country-menu" *ngIf="isCountryMenuOpen">
              <button
                type="button"
                class="country-option"
                *ngFor="let c of countries"
                (click)="selectCountry(c)">
                <img class="flag-img" [src]="c.flagUrl" [alt]="c.isoCode + ' flag'" />
                <span class="country-name">{{ c.name }}</span>
                <span class="country-dial">{{ c.dialCode }}</span>
              </button>
            </div>
          </div>

          <input
            type="tel"
            [(ngModel)]="form.phone"
            name="phone"
            placeholder="Phone number"
            class="phone-field" />
        </div>
        <small class="field-hint">Optional, but useful if you'd like to receive calls or SMS updates.</small>
        <small *ngIf="errors.phone">{{ errors.phone }}</small>
      </label>

      <label>
        <span>Password</span>
        <input type="password" [(ngModel)]="form.password" name="password" placeholder="At least 8 characters" />
        <small *ngIf="errors.password">{{ errors.password }}</small>
      </label>

      <label>
        <span>Confirm password</span>
        <input
          type="password"
          [(ngModel)]="form.confirmPassword"
          name="confirmPassword"
          placeholder="Re-enter your password"
        />
        <small *ngIf="errors.confirmPassword">{{ errors.confirmPassword }}</small>
      </label>

      <button type="submit" [disabled]="isSubmitting">
        {{ isSubmitting ? 'Creating Account...' : 'Create Account' }}
      </button>

      <button type="button" class="link" (click)="goToLogin()">Already have an account? Sign in</button>
    </form>

    <section class="trust-panel" aria-label="Security and trust">
      <div class="trust-item">
        <span class="trust-icon">üîí</span>
        <div>
          <h3>Enterprise-grade security</h3>
          <p>Your account and personal data are protected with modern security standards.</p>
        </div>
      </div>
      <div class="trust-item">
        <span class="trust-icon">üõ°Ô∏è</span>
        <div>
          <h3>Safe verification process</h3>
          <p>Email activation ensures only you can enable your account access.</p>
        </div>
      </div>
      <div class="trust-item">
        <span class="trust-icon">‚úÖ</span>
        <div>
          <h3>Trusted platform</h3>
          <p>Used by professionals to manage career opportunities with confidence.</p>
        </div>
      </div>
    </section>
  </div>

  <ng-template #successState>
    <div class="register-card success">
      <div class="top-actions success-top">
        <button type="button" class="link top-link" (click)="goToLogin()">Go to login</button>
      </div>
      <div class="icon">‚úì</div>
      <h1>Account created successfully</h1>
      <p>
        Your account is currently pending activation. Please check your email and click the activation link to continue.
      </p>
      <p class="success-note">Security first: your account stays inactive until email verification is completed.</p>
      <button type="button" (click)="goToLogin()">Back to Login</button>
    </div>
  </ng-template>

  <div class="modal-backdrop" *ngIf="showPopup">
    <div class="modal-card" (click)="$event.stopPropagation()">
      <h3>{{ popupTitle }}</h3>
      <p>{{ popupMessage }}</p>
      <button type="button" (click)="closePopup()">Understood</button>
    </div>
  </div>
</div>
