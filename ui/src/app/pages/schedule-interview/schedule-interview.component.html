<div class="form-view">
    <div class="form-card">
        <header class="form-hero">
            <span class="form-badge">New Interview</span>
            <h1>Schedule Interview</h1>
            <p class="subtitle">Keep your calendar aligned with every hiring step.</p>
            <div class="form-meta">Required fields are marked with <span class="required">*</span></div>
        </header>

        <form #interviewForm="ngForm" (ngSubmit)="onSubmit()" class="data-form">
            <section class="form-section">
                <div class="section-title">
                    <h2>Interview basics</h2>
                    <p>Choose the process and set the date, type, and focus.</p>
                </div>

                <div class="form-group required-section">
                    <label>Select Process <span class="required">*</span></label>
                    <p class="field-description">You must select an existing ongoing process to schedule an interview.</p>
                    <select name="processId" [(ngModel)]="interaction.processId" required class="input-field"
                        [class.error]="!interaction.processId && interviewForm.submitted">
                        <option value="">Choose a process...</option>
                        <option *ngFor="let process of processes" [value]="process.id">
                            {{process.companyName}} - {{process.roleTitle}} ({{process.currentStage}})
                        </option>
                    </select>
                    <p *ngIf="!interaction.processId && interviewForm.submitted" class="error-message">Please select a process</p>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label>Date & Time <span class="required">*</span></label>
                        <input type="datetime-local" name="date" [(ngModel)]="interaction.date" required class="input-field">
                    </div>

                    <div class="form-group">
                        <label>Interview Type <span class="required">*</span></label>
                        <select name="interviewType" [(ngModel)]="interaction.interviewType" class="input-field" required>
                            <option *ngFor="let type of interviewTypes" [value]="type">{{type}}</option>
                        </select>
                    </div>
                </div>

                <div class="form-group">
                    <label>Summary <span class="required">*</span></label>
                    <textarea name="summary" [(ngModel)]="interaction.summary" rows="3" required
                        placeholder="What is this interview about? Main topics, agenda, etc." class="input-field"></textarea>
                    <p class="muted-hint">Capture the main focus so you know how to prep for this step.</p>
                </div>
            </section>

            <section class="form-section">
                <div class="section-title">
                    <h2>Interviewers & attendees</h2>
                    <p>Track the people you will meet with and their roles.</p>
                </div>

                <div class="interviewers-block">
                    <div class="section-label-row">
                        <label>Interviewers (Participants)</label>
                        <button type="button" class="btn-text" (click)="addParticipant()">+ Add Person</button>
                    </div>

                    <div class="participants-list">
                        <div *ngFor="let p of interaction.participants; let i = index" class="participant-row">
                            <select [name]="'role' + i" [(ngModel)]="p.role" class="input-field small-select">
                                <option *ngFor="let role of availableRoles" [value]="role">{{role}}</option>
                            </select>
                            <input type="text" [name]="'name' + i" [(ngModel)]="p.name" placeholder="Name" class="input-field">
                            <button type="button" class="btn-remove" (click)="removeParticipant(i)" aria-label="Remove interviewer">&times;</button>
                        </div>
                        <p class="muted-hint" *ngIf="interaction.participants.length === 0">No interviewers added yet.</p>
                    </div>
                </div>
            </section>

            <section class="form-section">
                <div class="section-title">
                    <h2>Notes & preparation</h2>
                    <p>Add any helpful context so you show up prepared.</p>
                </div>

                <div class="form-group">
                    <label>Heads-up (Optional)</label>
                    <textarea name="headsup" [(ngModel)]="interaction.headsup" rows="2"
                        placeholder="Any important heads-up information for this interview..." class="input-field"></textarea>
                    <p class="muted-hint">Important information to remember before the interview (e.g., topics to avoid, prep needed).</p>
                </div>

                <div class="form-group">
                    <label>Comments / Notes (Optional)</label>
                    <textarea name="notes" [(ngModel)]="interaction.notes" rows="2"
                        placeholder="Additional notes or comments..." class="input-field"></textarea>
                </div>

                <div class="form-group">
                    <label>Tests / Technical Assessment (Optional)</label>
                    <textarea name="testsAssessment" [(ngModel)]="interaction.testsAssessment" rows="2"
                        placeholder="What tests or technical assessments are expected?" class="input-field"></textarea>
                </div>

                <div class="form-group">
                    <label>Role Insights (Optional)</label>
                    <textarea name="roleInsights" [(ngModel)]="interaction.roleInsights" rows="2"
                        placeholder="What do you know about this role that might be relevant?" class="input-field"></textarea>
                </div>
            </section>

            <div class="form-actions">
                <button type="button" class="btn-secondary" (click)="onCancel()">Cancel</button>
                <button type="submit" class="btn-primary" [disabled]="loading || !interviewForm.form.valid">
                    <span *ngIf="loading" class="spinner-small"></span>
                    {{loading ? 'Scheduling...' : 'Schedule Interview'}}
                </button>
            </div>
        </form>
    </div>
</div>
