// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider =  "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Process {
  id                Int            @id @default(autoincrement())
  companyName       String
  roleTitle         String
  techStack         String
  location          String
  workMode          String
  daysFromOffice    Int?           // For hybrid work mode: days per week in office
  source            String?
  salaryExpectation Int?
  currentStage      String
 dataFromThePhoneCall       String?
  createdAt         DateTime       @default(now())
  updatedAt         DateTime       @updatedAt

  // Initial Invitation Details
  initialInviteDate     DateTime?
  initialInviteMethod   String?
  initialInviteContent  String?

  // Offer Details (Optional)
  baseSalary        Int?
  equity            String?
  bonus             String?
  signingBonus      Int?
  benefits          String?
  offerDeadline     DateTime?
  nextFollowUp      DateTime?

  // Decision Matrix (Scores 1-10)
  scoreTech         Int?           @default(0)
  scoreWLB          Int?           @default(0)
  scoreGrowth       Int?           @default(0)
  scoreVibe         Int?           @default(0)

  // Removed old Coach Hub fields from Process to move to standalone Hub
  // Keeping interactions and contacts as they are process-specific

  interactions      Interaction[]
  reviews           SelfReview[]
  contacts          Contact[]
}

model Resource {
  id        Int      @id @default(autoincrement())
  title     String
  type      String   // 'CV', 'Pitch', 'Note', 'Question', 'File'
  content   String   // Text content or File URL
  tags      String?  // Comma separated tags
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

model Contact {
  id                Int            @id @default(autoincrement())
  name              String
  role              String?        // Recruiter, Hiring Manager, Peer
  linkedIn          String?
  socialHooks       String?        // Personal details to mention
  email             String?
  processId         Int
  process           Process        @relation(fields: [processId], references: [id], onDelete: Cascade)
}

model Interaction {
  id            Int      @id @default(autoincrement())
  processId     Int
  date          DateTime
  interviewType String
  participants  Json?
  summary       String
  testsAssessment String? // Tests or technical assessments during interview
  roleInsights  String?  // What was learned about the role during the call
  notes         String?
  headsup       String?  // Heads-up information for scheduled interview

  // Next Interview Invitation Tracking
  nextInviteStatus   String?    // 'Pending', 'Scheduled', 'Completed', 'Declined'
  nextInviteDate     DateTime?  // When the next interview is scheduled
  nextInviteLink     String?    // Link to calendar invite or email
  nextInviteType     String?    // Type of next interview (e.g., 'Technical Round 2')
  invitationExtended String?    // 'yes', 'later', or 'no' - was invitation extended in call?

  createdAt DateTime @default(now())

  process   Process  @relation(fields: [processId], references: [id], onDelete: Cascade)
}

model SelfReview {
  id            Int      @id @default(autoincrement())
  processId     Int
  stage         String
  confidence    Int
  whatWentWell  String
  whatFailed    String
  gaps          String
  createdAt     DateTime @default(now())

  process       Process  @relation(fields: [processId], references: [id], onDelete: Cascade)
}

model Pass {
  id        Int      @id @default(autoincrement())
  value     String
  createdAt DateTime @default(now())
}
